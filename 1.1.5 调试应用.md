# 调试应用


## 渲染进程


>最广泛使用来调试指定渲染进程的工具是 Chromium 的开发者工具集。 
它可以获取到所有的渲染进程，包括 BrowserWindow 的实例，BrowserView 以及 WebView。   
您可以通过编程的方式在 BrowserWindow 的 ebContents 中调用 openDevTool() API 来打开它们：

```
const { BrowserWindow } = require('electron')

let win = new BrowserWindow()
win.webContents.openDevTools()
````

- [谷歌 devtools 文档](https://developer.chrome.com/devtools)


## 主进程

>调试主进程有点棘手, 因为您不能简单地打开开发者工具来调试它们。   
多亏了谷歌和Node.js的紧密合作，Chromium开发者工具可以[被用来调试Electron的主进程](https://nodejs.org/en/docs/inspector/)，否则你也许会遇到许多怪事就像require不能再控制台中显示。

可以看[调试主进程的文档](https://electronjs.org/docs/tutorial/debugging-main-process)




## 调试主进程

>Electron 浏览器窗口中的 DevTools 只能调试 在该窗口中执行的 JavaScript (即 web 页面) 。  
为了提供一个可以调试主进程的方法，Electron 提供了 --inspect 和 --inspect-brk 开关。

#### 命令行开关
使用如下的命令行开关来调试 Electron 的主进程：
```
--inspect=[port]
```

当这个开关用于 Electron 时，它将会监听 V8 引擎中有关 port 的调试器协议信息。 默认的port 是 5858

```
electron --inspect=5858 your/app
```

--inspect-brk=[port]

和--inspector 一样，但是会在JavaScript 脚本的第一行暂停运行。

#### 外部调试器

你需要使用一个支持 V8 调试协议的调试器

通过访问 chrome://inspect 来连接 Chrome 并在那里选择需要检查的Electron 应用程序。
使用 [VSCode 进行主进程调试](https://electronjs.org/docs/tutorial/debugging-main-process-vscode)


#### 使用 VSCode 进行主进程调试

- 1.在 VSCode 中打开一个 Electron 项目。
```
$ git clone git@github.com:electron/electron-quick-start.git
$ code electron-quick-start
```

- 2.添加一个 .vscode/launch.json 文件并使用以下配置：
```
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Main Process",
      "type": "node",
      "request": "launch",
      "cwd": "${workspaceRoot}",
      "runtimeExecutable": "${workspaceRoot}/node_modules/.bin/electron",
      "windows": {
        "runtimeExecutable": "${workspaceRoot}/node_modules/.bin/electron.cmd"
      },
      "args" : ["."]
    }
  ]
}
```

- 3.调试
在 main.js中设置一些断点，并在 [Debug 视图](https://code.visualstudio.com/docs/editor/debugging) 中开始调试。你应该能够捕获断点信息。

- 这是一个预先配置的项目，你可以下载并直接在 VSCode中调试: [github.com/octref/vscode-electron-debug/tree/master/electron-quick-start](https://github.com/octref/vscode-electron-debug/tree/master/electron-quick-start)


## 参考
- [application-debugging](https://electronjs.org/docs/tutorial/application-debugging)
- [debugging-main-process](https://electronjs.org/docs/tutorial/debugging-main-process)
